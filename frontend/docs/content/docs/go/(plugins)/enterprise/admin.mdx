---
title: Admin API
description: Administrative API for managing users, sessions, roles, and system configuration
---

import { Callout } from 'fumadocs-ui/components/callout'
import { Tab, Tabs } from 'fumadocs-ui/components/tabs'

# Admin Plugin

Administrative API providing control over users, sessions, roles, and system monitoring. Designed for building custom admin dashboards and automation tools.

<Callout type="info">
The Admin Plugin provides API-only functionality. For a ready-to-use web interface, see the [Dashboard Plugin](/docs/go/plugins/core/dashboard).
</Callout>

## Features

- **User Management** - Create, list, and delete users
- **Security Operations** - Ban/unban users, impersonate users
- **Session Management** - List and revoke sessions
- **Role Management** - Assign roles to users
- **System Statistics** - User counts, active sessions, security events
- **Audit Logs** - Query and filter audit events
- **RBAC Integration** - Admin and SuperAdmin roles with granular permissions

## Quick Start

### Installation

```go
import (
    "github.com/xraph/authsome"
    "github.com/xraph/authsome/plugins/admin"
)

auth := authsome.New(
    authsome.WithDatabase(db),
    authsome.WithPlugins(
        admin.NewPlugin(),
    ),
)
```

### Configuration

```yaml
auth:
  plugins:
    admin:
      requiredRole: "admin"
      allowUserCreation: true
      allowUserDeletion: true
      allowImpersonation: true
      maxImpersonationDuration: "24h"
```

| Field | Type | Default | Description |
|---|---|---|---|
| `requiredRole` | string | `"admin"` | Minimum role required for admin access |
| `allowUserCreation` | bool | `true` | Allow creating users via admin API |
| `allowUserDeletion` | bool | `true` | Allow deleting users via admin API |
| `allowImpersonation` | bool | `true` | Allow impersonating users |
| `maxImpersonationDuration` | duration | `24h` | Maximum impersonation session duration |

## RBAC Roles

The Admin plugin automatically registers two roles:

### Admin Role
- **Inherits from**: Member
- **Permissions**: User CRUD, ban/unban, session management, role assignment, stats, audit logs

### SuperAdmin Role
- **Inherits from**: Admin
- **Additional permissions**: User impersonation, full wildcard access (`* on admin:*`)

## API Reference

### User Management

#### Create User

```bash
curl -X POST https://auth.yourdomain.com/admin/users \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "newuser@example.com",
    "name": "New User",
    "password": "secure-password"
  }'
```

#### List Users

```bash
curl https://auth.yourdomain.com/admin/users \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

#### Delete User

```bash
curl -X DELETE https://auth.yourdomain.com/admin/users/{user_id} \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

### Security Operations

#### Ban User

```bash
curl -X POST https://auth.yourdomain.com/admin/users/{user_id}/ban \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "reason": "Terms of service violation",
    "expiresAt": "2025-12-31T23:59:59Z"
  }'
```

#### Unban User

```bash
curl -X POST https://auth.yourdomain.com/admin/users/{user_id}/unban \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

#### Impersonate User

<Callout type="warn">
Impersonation requires SuperAdmin role and is always audit logged.
</Callout>

```bash
curl -X POST https://auth.yourdomain.com/admin/users/{user_id}/impersonate \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

### Session Management

#### List Sessions

```bash
curl https://auth.yourdomain.com/admin/sessions \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

#### Revoke Session

```bash
curl -X DELETE https://auth.yourdomain.com/admin/sessions/{session_id} \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

### Role Management

#### Set User Role

```bash
curl -X POST https://auth.yourdomain.com/admin/users/{user_id}/role \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "role": "admin"
  }'
```

### Statistics & Monitoring

#### Get Dashboard Stats

```bash
curl https://auth.yourdomain.com/admin/stats \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

Response:
```json
{
  "users": {
    "total": 1250,
    "activeToday": 342,
    "newThisMonth": 87
  },
  "sessions": {
    "active": 456,
    "totalToday": 1823
  },
  "security": {
    "failedLoginsToday": 12,
    "bannedUsers": 3
  }
}
```

#### Get Audit Logs

```bash
curl https://auth.yourdomain.com/admin/audit-logs \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

## Route Summary

| Method | Path | Description | Permission |
|---|---|---|---|
| `POST` | `/admin/users` | Create user | `admin:user:create` |
| `GET` | `/admin/users` | List users | `admin:user:read` |
| `DELETE` | `/admin/users/:id` | Delete user | `admin:user:delete` |
| `POST` | `/admin/users/:id/ban` | Ban user | `admin:user:ban` |
| `POST` | `/admin/users/:id/unban` | Unban user | `admin:user:ban` |
| `POST` | `/admin/users/:id/impersonate` | Impersonate user | `admin:user:impersonate` |
| `POST` | `/admin/users/:id/role` | Set user role | `admin:role:assign` |
| `GET` | `/admin/sessions` | List sessions | `admin:session:read` |
| `DELETE` | `/admin/sessions/:id` | Revoke session | `admin:session:revoke` |
| `GET` | `/admin/stats` | Get statistics | `admin:stats:read` |
| `GET` | `/admin/audit-logs` | Get audit logs | `admin:audit:read` |

## Security

### Authentication

The Admin API requires authentication with elevated permissions:

- Bearer tokens with admin or superadmin role
- All actions are audit logged automatically

### Audit Logging

All admin actions are automatically logged with:

```json
{
  "timestamp": "2025-01-15T10:30:00Z",
  "actorId": "admin_user_123",
  "action": "user.ban",
  "resourceType": "user",
  "resourceId": "user_456",
  "ipAddress": "192.168.1.1",
  "userAgent": "curl/8.0"
}
```

<Callout type="warning">
Admin API credentials should be stored securely and rotated regularly. Consider using the Bearer plugin with session-based auth or the API Key plugin for programmatic access.
</Callout>

## Resources

- [Admin Plugin Source](https://github.com/xraph/authsome/tree/main/plugins/admin)
- [Dashboard Plugin](/docs/go/plugins/core/dashboard)
