plugin_id: social
version: 1.0.0
routes:
    - name: SignIn
      description: |-
        SignIn initiates OAuth flow for sign-in
        POST /api/auth/signin/social
      method: POST
      path: /signin/social
      request:
        provider: string!
        redirectUrl: string!
        scopes: '[]string!'
      response:
        url: string!
      request_type: SignInRequest
      response_type: AuthURLResponse
    - name: Callback
      description: |-
        Callback handles OAuth provider callback
        GET /api/auth/callback/:provider
      method: GET
      path: /callback/:provider
      query:
        state: string!
        code: string
        error: string
        errorDescription: string
      response:
        action: string!
        isNewUser: bool!
        user: '*schema.User!'
      response_type: CallbackDataResponse
    - name: LinkAccount
      description: |-
        LinkAccount links a social provider to the current user
        POST /api/auth/account/link
      method: POST
      path: /account/link
      request:
        provider: string!
        scopes: '[]string!'
      response:
        url: string!
      request_type: LinkAccountRequest
      response_type: AuthURLResponse
    - name: UnlinkAccount
      description: |-
        UnlinkAccount unlinks a social provider from the current user
        DELETE /api/auth/account/unlink/:provider
      method: DELETE
      path: /account/unlink/:provider
      response_type: MessageResponse
    - name: ListProviders
      description: |-
        ListProviders returns available OAuth providers
        GET /api/auth/providers
      method: GET
      path: /providers
      response:
        providers: '[]string!'
      response_type: ProvidersResponse
types:
    - name: Plugin
      fields:
        "": Config
    - name: ProvidersConfig
      fields:
        apple: '*providers.ProviderConfig!'
        bitbucket: '*providers.ProviderConfig!'
        discord: '*providers.ProviderConfig!'
        dropbox: '*providers.ProviderConfig!'
        facebook: '*providers.ProviderConfig!'
        github: '*providers.ProviderConfig!'
        gitlab: '*providers.ProviderConfig!'
        google: '*providers.ProviderConfig!'
        line: '*providers.ProviderConfig!'
        linkedin: '*providers.ProviderConfig!'
        microsoft: '*providers.ProviderConfig!'
        notion: '*providers.ProviderConfig!'
        reddit: '*providers.ProviderConfig!'
        slack: '*providers.ProviderConfig!'
        spotify: '*providers.ProviderConfig!'
        twitch: '*providers.ProviderConfig!'
        twitter: '*providers.ProviderConfig!'
    - name: Handler
      fields:
        "": '*RateLimiter'
    - name: LinkAccountRequest
      fields:
        provider: string!
        scopes: '[]string!'
    - name: AuthURLResponse
      fields:
        url: string!
    - name: CallbackDataResponse
      fields:
        action: string!
        isNewUser: bool!
        user: '*schema.User!'
    - name: ProviderConfigResponse
      fields:
        appId: string!
        message: string!
        provider: string!
    - name: OAuthState
      fields:
        app_id: xid.ID!
        created_at: time.Time!
        extra_scopes: '[]string!'
        link_user_id: '*xid.ID!'
        provider: string!
        redirect_url: string!
        user_organization_id: '*xid.ID!'
    - name: stateEntry
      fields:
        "": time.Time
    - name: Config
      fields:
        allowAccountLinking: bool!
        autoCreateUser: bool!
        baseUrl: string!
        providers: ProvidersConfig!
        requireEmailVerified: bool!
        stateStorage: StateStorageConfig!
        trustEmailVerified: bool!
    - name: ConnectionResponse
      fields:
        connection: '*schema.SocialAccount!'
    - name: ConnectionsResponse
      fields:
        connections: '[]*schema.SocialAccount!'
    - name: ProvidersAppResponse
      fields:
        appId: string!
        providers: '[]string!'
    - name: RateLimiter
      fields:
        "": ""
    - name: Service
      fields:
        "": '*user.Service'
    - name: CallbackResult
      fields:
        "": bool
    - name: MockStateStore
      fields:
        "": ""
    - name: AdminAddProviderRequest
      fields:
        appId: xid.ID!
        clientId: string!
        clientSecret: string!
        enabled: bool!
        provider: string!
        scopes: '[]string!'
    - name: AdminUpdateProviderRequest
      fields:
        clientId: '*string!'
        clientSecret: '*string!'
        enabled: '*bool!'
        scopes: '[]string!'
    - name: RateLimit
      fields:
        "": time.Duration
    - name: MockSocialAccountRepository
      fields: {}
    - name: MockUserRepository
      fields: {}
    - name: StateStorageConfig
      fields:
        redisAddr: string!
        redisDb: int!
        redisPassword: string!
        stateTtl: time.Duration!
        useRedis: bool!
    - name: SignInRequest
      fields:
        provider: string!
        redirectUrl: string!
        scopes: '[]string!'
    - name: CallbackResponse
      fields:
        session: '*session.Session!'
        token: string!
        user: '*user.User!'
    - name: ProvidersResponse
      fields:
        providers: '[]string!'
    - name: MemoryStateStore
      fields: {}
    - name: RedisStateStore
      fields:
        client: '*redis.Client'
