plugin_id: phone
version: 1.0.0
routes:
    - name: SendCode
      description: SendCode handles sending of verification code via SMS
      method: POST
      path: /phone/send-code
      request:
        phone: string!
      request_type: SendCode_body
    - name: Verify
      description: Verify checks the code and creates a session on success
      method: POST
      path: /phone/verify
      request:
        code: string!
        email: string!
        phone: string!
        remember: bool!
      response:
        session: '!'
        token: string!
        user: '!'
      request_type: Verify_body
      response_type: VerifyResponse
    - name: SignIn
      description: SignIn aliases to Verify for convenience
      method: POST
      path: /phone/signin
      request:
        code: string!
        email: string!
        phone: string!
        remember: bool!
      response:
        session: '!'
        token: string!
        user: '!'
      request_type: SignIn_body
      response_type: VerifyResponse
types:
    - name: VerifyResponse
      fields:
        session: '!'
        token: string!
        user: '!'
    - name: SendCode_body
      fields:
        phone: string!
    - name: Verify_body
      fields:
        code: string!
        email: string!
        phone: string!
        remember: bool!
    - name: SignIn_body
      fields:
        code: string!
        email: string!
        phone: string!
        remember: bool!
    - name: Plugin
      fields:
        "": Config
    - name: PhoneSendCodeResponse
      fields:
        dev_code: string!
        status: string!
    - name: PhoneVerifyResponse
      fields:
        session: '!'
        token: string!
        user: '!'
    - name: Handler
      fields:
        "": '*rl.Service'
    - name: Config
      fields:
        allowImplicitSignup: bool!
        codeLength: int!
        devExposeCode: bool!
        expiryMinutes: int!
        maxAttempts: int!
        rateLimitPerHour: int!
        smsProvider: string!
    - name: PhoneErrorResponse
      fields:
        error: string!
    - name: Service
      fields:
        "": '*auth.Service'
