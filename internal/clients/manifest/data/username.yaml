plugin_id: username
version: 1.0.0
routes:
    - name: SignUp
      description: SignUp handles user registration with username and password
      method: POST
      path: /username/signup
      response:
        message: string!
        status: string!
      response_type: SignUpResponse
    - name: SignIn
      description: SignIn handles user authentication with username and password
      method: POST
      path: /username/signin
      response:
        session: '*session.Session!'
        token: string!
        user: '*user.User!'
      response_type: SignInResponse
types:
    - name: SignInRequest
      fields:
        password: string!
        remember: bool!
        username: string!
    - name: SignInResponse
      fields:
        session: '*session.Session!'
        token: string!
        user: '*user.User!'
    - name: Plugin
      fields:
        "": '*repo.UsernameRepository'
    - name: Config
      fields:
        allowUsernameLogin: bool!
        failedAttemptWindow: time.Duration!
        lockoutDuration: time.Duration!
        lockoutEnabled: bool!
        maxFailedAttempts: int!
        maxPasswordLength: int!
        minPasswordLength: int!
        passwordExpiryDays: int!
        passwordExpiryEnabled: bool!
        passwordExpiryWarningDays: int!
        passwordHistorySize: int!
        preventPasswordReuse: bool!
        rateLimit: RateLimitConfig!
        requireLowercase: bool!
        requireNumber: bool!
        requireSpecialChar: bool!
        requireUppercase: bool!
    - name: RateLimitConfig
      fields:
        enabled: bool!
        redisAddr: string!
        redisDb: int!
        redisPassword: string!
        signinPerIp: RateLimitRule!
        signinPerUser: RateLimitRule!
        signupPerIp: RateLimitRule!
        useRedis: bool!
    - name: RateLimitRule
      fields:
        max: int!
        window: time.Duration!
    - name: Service
      fields:
        "": Config
    - name: Handler
      fields:
        "": '*Service'
    - name: SignUpResponse
      fields:
        message: string!
        status: string!
    - name: TwoFARequiredResponse
      fields:
        device_id: string!
        require_twofa: bool!
        user: '*user.User!'
    - name: AccountLockedResponse
      fields:
        code: string!
        locked_minutes: int!
        locked_until: time.Time!
        message: string!
    - name: AccountLockoutError
      fields:
        "": int
    - name: SignUpRequest
      fields:
        password: string!
        username: string!
