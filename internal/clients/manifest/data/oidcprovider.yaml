plugin_id: oidcprovider
version: 1.0.0
routes:
    - name: RegisterClient
      description: RegisterClient handles dynamic client registration (admin only)
      method: POST
      path: /oauth2/register
      request:
        application_type: string!
        client_name: string!
        contacts: '[]string!'
        grant_types: '[]string!'
        logo_uri: string!
        policy_uri: string!
        post_logout_redirect_uris: '[]string!'
        redirect_uris: '[]string!'
        require_consent: bool!
        require_pkce: bool!
        response_types: '[]string!'
        scope: string!
        token_endpoint_auth_method: string!
        tos_uri: string!
        trusted_client: bool!
      response:
        application_type: string!
        client_id: string!
        client_id_issued_at: int64!
        client_name: string!
        client_secret: string!
        client_secret_expires_at: int64!
        contacts: '[]string!'
        grant_types: '[]string!'
        logo_uri: string!
        policy_uri: string!
        post_logout_redirect_uris: '[]string!'
        redirect_uris: '[]string!'
        response_types: '[]string!'
        scope: string!
        token_endpoint_auth_method: string!
        tos_uri: string!
      request_type: ClientRegistrationRequest
      response_type: ClientRegistrationResponse
    - name: ListClients
      description: ListClients lists all OAuth clients for the current app/env/org
      method: GET
      path: /oauth2/clients
      response:
        clients: '[]ClientSummary!'
        page: int!
        pageSize: int!
        total: int!
        totalPages: int!
      response_type: ClientsListResponse
    - name: GetClient
      description: GetClient retrieves detailed information about an OAuth client
      method: GET
      path: /oauth2/clients/:clientId
      response:
        allowedScopes: '[]string!'
        applicationType: string!
        clientID: string!
        contacts: '[]string!'
        createdAt: string!
        grantTypes: '[]string!'
        isOrgLevel: bool!
        logoURI: string!
        name: string!
        organizationID: string!
        policyURI: string!
        postLogoutRedirectURIs: '[]string!'
        redirectURIs: '[]string!'
        requireConsent: bool!
        requirePKCE: bool!
        responseTypes: '[]string!'
        tokenEndpointAuthMethod: string!
        tosURI: string!
        trustedClient: bool!
        updatedAt: string!
      response_type: ClientDetailsResponse
    - name: UpdateClient
      description: UpdateClient updates an existing OAuth client
      method: PUT
      path: /oauth2/clients/:clientId
      request:
        allowed_scopes: '[]string!'
        contacts: '[]string!'
        grant_types: '[]string!'
        logo_uri: string!
        name: string!
        policy_uri: string!
        post_logout_redirect_uris: '[]string!'
        redirect_uris: '[]string!'
        require_consent: '*bool!'
        require_pkce: '*bool!'
        response_types: '[]string!'
        token_endpoint_auth_method: string!
        tos_uri: string!
        trusted_client: '*bool!'
      response:
        allowedScopes: '[]string!'
        applicationType: string!
        clientID: string!
        contacts: '[]string!'
        createdAt: string!
        grantTypes: '[]string!'
        isOrgLevel: bool!
        logoURI: string!
        name: string!
        organizationID: string!
        policyURI: string!
        postLogoutRedirectURIs: '[]string!'
        redirectURIs: '[]string!'
        requireConsent: bool!
        requirePKCE: bool!
        responseTypes: '[]string!'
        tokenEndpointAuthMethod: string!
        tosURI: string!
        trustedClient: bool!
        updatedAt: string!
      request_type: ClientUpdateRequest
      response_type: ClientDetailsResponse
    - name: DeleteClient
      description: DeleteClient deletes an OAuth client
      method: DELETE
      path: /oauth2/clients/:clientId
    - name: Discovery
      description: Discovery handles the OIDC discovery endpoint (.well-known/openid-configuration)
      method: GET
      path: /oauth2/.well-known/openid-configuration
      response:
        authorization_endpoint: string!
        claims_parameter_supported: bool!
        claims_supported: '[]string!'
        code_challenge_methods_supported: '[]string!'
        device_authorization_endpoint: string!
        grant_types_supported: '[]string!'
        id_token_signing_alg_values_supported: '[]string!'
        introspection_endpoint: string!
        introspection_endpoint_auth_methods_supported: '[]string!'
        issuer: string!
        jwks_uri: string!
        registration_endpoint: string!
        request_parameter_supported: bool!
        request_uri_parameter_supported: bool!
        require_request_uri_registration: bool!
        response_modes_supported: '[]string!'
        response_types_supported: '[]string!'
        revocation_endpoint: string!
        revocation_endpoint_auth_methods_supported: '[]string!'
        scopes_supported: '[]string!'
        subject_types_supported: '[]string!'
        token_endpoint: string!
        token_endpoint_auth_methods_supported: '[]string!'
        userinfo_endpoint: string!
      response_type: DiscoveryResponse
    - name: JWKS
      description: JWKS returns the JSON Web Key Set
      method: GET
      path: /oauth2/jwks
      response:
        keys: '[]JWK!'
      response_type: JWKSResponse
    - name: Authorize
      description: Authorize handles OAuth2/OIDC authorization requests
      method: GET
      path: /oauth2/authorize
    - name: HandleConsent
      description: HandleConsent processes the consent form submission
      method: POST
      path: /oauth2/consent
      request:
        action: string!
        client_id: string!
        code_challenge: string!
        code_challenge_method: string!
        redirect_uri: string!
        response_type: string!
        scope: string!
        state: string!
      request_type: ConsentRequest
    - name: Token
      description: Token handles the token endpoint
      method: POST
      path: /oauth2/token
      request:
        audience: string!
        client_id: string!
        client_secret: string!
        code: string!
        code_verifier: string!
        device_code: string!
        grant_type: string!
        redirect_uri: string!
        refresh_token: string!
        scope: string!
      response:
        access_token: string!
        expires_in: int!
        id_token: string!
        refresh_token: string!
        scope: string!
        token_type: string!
      request_type: TokenRequest
      response_type: TokenResponse
    - name: UserInfo
      description: UserInfo returns user information based on the access token
      method: GET
      path: /oauth2/userinfo
      response:
        birthdate: string!
        email: string!
        email_verified: bool!
        family_name: string!
        gender: string!
        given_name: string!
        locale: string!
        middle_name: string!
        name: string!
        nickname: string!
        phone_number: string!
        phone_number_verified: bool!
        picture: string!
        preferred_username: string!
        profile: string!
        sub: string!
        updated_at: int64!
        website: string!
        zoneinfo: string!
      response_type: UserInfoResponse
    - name: IntrospectToken
      description: IntrospectToken handles token introspection requests
      method: POST
      path: /oauth2/introspect
      request:
        client_id: string!
        client_secret: string!
        token: string!
        token_type_hint: string!
      response:
        active: bool!
        aud: '[]string!'
        client_id: string!
        exp: int64!
        iat: int64!
        iss: string!
        jti: string!
        nbf: int64!
        scope: string!
        sub: string!
        token_type: string!
        username: string!
      request_type: TokenIntrospectionRequest
      response_type: TokenIntrospectionResponse
    - name: RevokeToken
      description: RevokeToken handles token revocation requests
      method: POST
      path: /oauth2/revoke
      request:
        client_id: string!
        client_secret: string!
        token: string!
        token_type_hint: string!
      request_type: TokenRevocationRequest
      response_type: responses.StatusResponse
    - name: DeviceAuthorize
      description: DeviceAuthorize initiates the device authorization flow
      method: POST
      path: /oauth2/device_authorization
      request:
        client_id: string!
        scope: string!
      response:
        device_code: string!
        expires_in: int!
        interval: int!
        user_code: string!
        verification_uri: string!
        verification_uri_complete: string!
      request_type: DeviceAuthorizationRequest
      response_type: DeviceAuthorizationResponse
    - name: DeviceCodeEntry
      description: DeviceCodeEntry shows the device code entry form
      method: GET
      path: /oauth2/device
      response:
        basePath: string!
        formAction: string!
        placeholder: string!
      response_type: DeviceCodeEntryResponse
    - name: DeviceVerify
      description: DeviceVerify verifies the user code and shows the consent screen
      method: POST
      path: /oauth2/device/verify
      request:
        user_code: string!
      response:
        authorizeUrl: string!
        clientId: string!
        clientName: string!
        logoUri: string!
        scopes: '[]ScopeInfo!'
        userCode: string!
        userCodeFormatted: string!
      request_type: DeviceVerificationRequest
      response_type: DeviceVerifyResponse
    - name: DeviceAuthorizeDecision
      description: DeviceAuthorizeDecision handles the user's authorization decision
      method: POST
      path: /oauth2/device/authorize
      request:
        action: string!
        user_code: string!
      response:
        approved: bool!
        message: string!
        success: bool!
      request_type: DeviceAuthorizationDecisionRequest
      response_type: DeviceDecisionResponse
types:
    - name: UserInfoResponse
      fields:
        birthdate: string!
        email: string!
        email_verified: bool!
        family_name: string!
        gender: string!
        given_name: string!
        locale: string!
        middle_name: string!
        name: string!
        nickname: string!
        phone_number: string!
        phone_number_verified: bool!
        picture: string!
        preferred_username: string!
        profile: string!
        sub: string!
        updated_at: int64!
        website: string!
        zoneinfo: string!
    - name: JWKSResponse
      fields:
        keys: '[]JWK!'
    - name: ClientUpdateRequest
      fields:
        allowed_scopes: '[]string!'
        contacts: '[]string!'
        grant_types: '[]string!'
        logo_uri: string!
        name: string!
        policy_uri: string!
        post_logout_redirect_uris: '[]string!'
        redirect_uris: '[]string!'
        require_consent: '*bool!'
        require_pkce: '*bool!'
        response_types: '[]string!'
        token_endpoint_auth_method: string!
        tos_uri: string!
        trusted_client: '*bool!'
    - name: DiscoveryService
      fields:
        "": Config
    - name: AuthorizeRequest
      fields:
        acr_values: string!
        client_id: string!
        code_challenge: string!
        code_challenge_method: string!
        id_token_hint: string!
        login_hint: string!
        max_age: '*int!'
        nonce: string!
        prompt: string!
        redirect_uri: string!
        response_type: string!
        scope: string!
        state: string!
        ui_locales: string!
    - name: ClientsListResponse
      fields:
        clients: '[]ClientSummary!'
        page: int!
        pageSize: int!
        total: int!
        totalPages: int!
    - name: ConsentDecision
      fields:
        "": '[]string'
    - name: DeviceAuthorizationResponse
      fields:
        device_code: string!
        expires_in: int!
        interval: int!
        user_code: string!
        verification_uri: string!
        verification_uri_complete: string!
    - name: DeviceCodeEntryResponse
      fields:
        basePath: string!
        formAction: string!
        placeholder: string!
    - name: DeviceVerifyResponse
      fields:
        authorizeUrl: string!
        clientId: string!
        clientName: string!
        logoUri: string!
        scopes: '[]ScopeInfo!'
        userCode: string!
        userCodeFormatted: string!
    - name: DeviceDecisionResponse
      fields:
        approved: bool!
        message: string!
        success: bool!
    - name: JWK
      fields:
        alg: string!
        e: string!
        kid: string!
        kty: string!
        "n": string!
        use: string!
    - name: IDTokenClaims
      fields:
        auth_time: int64!
        email: string!
        email_verified: bool!
        family_name: string!
        given_name: string!
        name: string!
        nonce: string!
        preferred_username: string!
        session_state: string!
    - name: RegistrationService
      fields:
        "": Config
    - name: serviceAdapter
      fields:
        "": '*Service'
    - name: ClientRegistrationRequest
      fields:
        application_type: string!
        client_name: string!
        contacts: '[]string!'
        grant_types: '[]string!'
        logo_uri: string!
        policy_uri: string!
        post_logout_redirect_uris: '[]string!'
        redirect_uris: '[]string!'
        require_consent: bool!
        require_pkce: bool!
        response_types: '[]string!'
        scope: string!
        token_endpoint_auth_method: string!
        tos_uri: string!
        trusted_client: bool!
    - name: DiscoveryResponse
      fields:
        authorization_endpoint: string!
        claims_parameter_supported: bool!
        claims_supported: '[]string!'
        code_challenge_methods_supported: '[]string!'
        device_authorization_endpoint: string!
        grant_types_supported: '[]string!'
        id_token_signing_alg_values_supported: '[]string!'
        introspection_endpoint: string!
        introspection_endpoint_auth_methods_supported: '[]string!'
        issuer: string!
        jwks_uri: string!
        registration_endpoint: string!
        request_parameter_supported: bool!
        request_uri_parameter_supported: bool!
        require_request_uri_registration: bool!
        response_modes_supported: '[]string!'
        response_types_supported: '[]string!'
        revocation_endpoint: string!
        revocation_endpoint_auth_methods_supported: '[]string!'
        scopes_supported: '[]string!'
        subject_types_supported: '[]string!'
        token_endpoint: string!
        token_endpoint_auth_methods_supported: '[]string!'
        userinfo_endpoint: string!
    - name: OAuthErrorResponse
      fields:
        error: string!
        error_description: string!
        error_uri: string!
        state: string!
    - name: JWKSService
      fields:
        "": '*KeyStore'
    - name: userServiceAdapter
      fields:
        "": '*user.Service'
    - name: deviceFlowServiceAdapter
      fields:
        "": '*deviceflow.Service'
    - name: ClientRegistrationResponse
      fields:
        application_type: string!
        client_id: string!
        client_id_issued_at: int64!
        client_name: string!
        client_secret: string!
        client_secret_expires_at: int64!
        contacts: '[]string!'
        grant_types: '[]string!'
        logo_uri: string!
        policy_uri: string!
        post_logout_redirect_uris: '[]string!'
        redirect_uris: '[]string!'
        response_types: '[]string!'
        scope: string!
        token_endpoint_auth_method: string!
        tos_uri: string!
    - name: TokenRevocationRequest
      fields:
        client_id: string!
        client_secret: string!
        token: string!
        token_type_hint: string!
    - name: ClientDetailsResponse
      fields:
        allowedScopes: '[]string!'
        applicationType: string!
        clientID: string!
        contacts: '[]string!'
        createdAt: string!
        grantTypes: '[]string!'
        isOrgLevel: bool!
        logoURI: string!
        name: string!
        organizationID: string!
        policyURI: string!
        postLogoutRedirectURIs: '[]string!'
        redirectURIs: '[]string!'
        requireConsent: bool!
        requirePKCE: bool!
        responseTypes: '[]string!'
        tokenEndpointAuthMethod: string!
        tosURI: string!
        trustedClient: bool!
        updatedAt: string!
    - name: ClientAuthResult
      fields:
        "": string
    - name: DeviceAuthorizationRequest
      fields:
        client_id: string!
        scope: string!
    - name: ConsentManager
      fields:
        "": '*ConsentService'
    - name: TokenIntrospectionResponse
      fields:
        active: bool!
        aud: '[]string!'
        client_id: string!
        exp: int64!
        iat: int64!
        iss: string!
        jti: string!
        nbf: int64!
        scope: string!
        sub: string!
        token_type: string!
        username: string!
    - name: ClientSummary
      fields:
        applicationType: string!
        clientID: string!
        createdAt: string!
        isOrgLevel: bool!
        name: string!
    - name: DeviceAuthorizationDecisionRequest
      fields:
        action: string!
        user_code: string!
    - name: JWKS
      fields:
        keys: '[]JWK!'
    - name: ConsentRequest
      fields:
        action: string!
        client_id: string!
        code_challenge: string!
        code_challenge_method: string!
        redirect_uri: string!
        response_type: string!
        scope: string!
        state: string!
    - name: TokenRequest
      fields:
        audience: string!
        client_id: string!
        client_secret: string!
        code: string!
        code_verifier: string!
        device_code: string!
        grant_type: string!
        redirect_uri: string!
        refresh_token: string!
        scope: string!
    - name: DeviceVerificationRequest
      fields:
        user_code: string!
    - name: DashboardExtension
      fields:
        "": '*pages.PagesManager'
    - name: Handler
      fields:
        "": '*IntrospectionService'
    - name: AccessTokenClaims
      fields:
        client_id: string!
        scope: string!
        token_type: string!
    - name: TokenResponse
      fields:
        access_token: string!
        expires_in: int!
        id_token: string!
        refresh_token: string!
        scope: string!
        token_type: string!
    - name: TokenIntrospectionRequest
      fields:
        client_id: string!
        client_secret: string!
        token: string!
        token_type_hint: string!
    - name: ScopeInfo
      fields:
        "": string
    - name: AdminHandler
      fields:
        "": '*RegistrationService'
    - name: ClientAuthenticator
      fields:
        "": '*repo.OAuthClientRepository'
    - name: ConsentService
      fields:
        "": '*repo.OAuthClientRepository'
    - name: IntrospectionService
      fields:
        "": '*repo.OAuthTokenRepository'
    - name: JWTService
      fields:
        "": string
    - name: Service
      fields:
        "": Config
    - name: DeviceVerificationInfo
      fields:
        "": '[]ScopeInfo'
    - name: KeyPair
      fields:
        "": time.Time
    - name: KeyStore
      fields:
        "": ""
    - name: Config
      fields:
        deviceFlow: '!'
        issuer: string!
        keys: '!'
        tokens: '!'
    - name: Plugin
      fields:
        "": '*DashboardExtension'
    - name: RevokeTokenService
      fields:
        "": '*repo.OAuthTokenRepository'
