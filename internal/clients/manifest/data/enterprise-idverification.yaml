plugin_id: idverification
version: 1.0.0
routes:
    - name: CreateVerificationSession
      description: |-
        CreateVerificationSession creates a new verification session
        POST /verification/sessions
      method: POST
      path: /sessions
      request:
        cancelUrl: string!
        config: '!'
        metadata: '!'
        provider: string!
        requiredChecks: '[]string!'
        successUrl: string!
      response:
        session: '*schema.IdentityVerificationSession!'
      request_type: CreateVerificationSession_req
      response_type: VerificationSessionResponse
    - name: GetVerificationSession
      description: |-
        GetVerificationSession retrieves a verification session
        GET /verification/sessions/:id
      method: GET
      path: /sessions/:id
      response:
        session: '*schema.IdentityVerificationSession!'
      response_type: VerificationSessionResponse
    - name: GetVerification
      description: |-
        GetVerification retrieves a verification by ID
        GET /verification/:id
      method: GET
      path: /:id
      response:
        verification: '*schema.IdentityVerification!'
      response_type: VerificationResponse
    - name: GetUserVerifications
      description: |-
        GetUserVerifications retrieves all verifications for the current user
        GET /verification/me
      method: GET
      path: /me
      response:
        limit: int!
        offset: int!
        total: int!
        verifications: '[]*schema.IdentityVerification!'
      response_type: VerificationListResponse
    - name: GetUserVerificationStatus
      description: |-
        GetUserVerificationStatus retrieves the verification status for the current user
        GET /verification/me/status
      method: GET
      path: /me/status
      response:
        status: '*schema.UserVerificationStatus!'
      response_type: UserVerificationStatusResponse
    - name: RequestReverification
      description: |-
        RequestReverification requests re-verification for the current user
        POST /verification/me/reverify
      method: POST
      path: /me/reverify
      request:
        reason: string!
      request_type: RequestReverification_req
      response_type: MessageResponse
    - name: HandleWebhook
      description: |-
        HandleWebhook handles provider webhook callbacks
        POST /verification/webhook/:provider
      method: POST
      path: /webhook/:provider
    - name: AdminBlockUser
      description: |-
        AdminBlockUser blocks a user from verification (admin only)
        POST /verification/admin/users/:userId/block
      method: POST
      path: /users/:userId/block
      request:
        reason: string!
      request_type: AdminBlockUser_req
      response_type: MessageResponse
    - name: AdminUnblockUser
      description: |-
        AdminUnblockUser unblocks a user (admin only)
        POST /verification/admin/users/:userId/unblock
      method: POST
      path: /users/:userId/unblock
      response_type: MessageResponse
    - name: AdminGetUserVerificationStatus
      description: |-
        AdminGetUserVerificationStatus retrieves verification status for any user (admin only)
        GET /verification/admin/users/:userId/status
      method: GET
      path: /users/:userId/status
      response:
        status: '*schema.UserVerificationStatus!'
      response_type: UserVerificationStatusResponse
    - name: AdminGetUserVerifications
      description: |-
        AdminGetUserVerifications retrieves all verifications for any user (admin only)
        GET /verification/admin/users/:userId/verifications
      method: GET
      path: /users/:userId/verifications
      response:
        limit: int!
        offset: int!
        total: int!
        verifications: '[]*schema.IdentityVerification!'
      response_type: VerificationListResponse
types:
    - name: IDVerificationStatusResponse
      fields:
        status: '!'
    - name: mockRepository
      fields:
        "": error
    - name: CreateSessionRequest
      fields:
        "": ""
    - name: VerificationResult
      fields:
        "": int
    - name: ProviderCheckResult
      fields:
        "": bool
    - name: IDVerificationWebhookResponse
      fields:
        status: string!
    - name: VerificationSessionResponse
      fields:
        session: '*schema.IdentityVerificationSession!'
    - name: ProviderSessionRequest
      fields:
        "": ""
    - name: BlockUserRequest
      fields:
        reason: string!
    - name: FacialCheckConfig
      fields:
        enabled: bool!
        motionCapture: bool!
        variant: string!
    - name: StripeIdentityConfig
      fields:
        allowedTypes: '[]string!'
        apiKey: string!
        enabled: bool!
        requireLiveCapture: bool!
        requireMatchingSelfie: bool!
        returnUrl: string!
        useMock: bool!
        webhookSecret: string!
    - name: IDVerificationSessionResponse
      fields:
        session: '!'
    - name: CreateSessionHTTPRequest
      fields:
        cancelUrl: string!
        config: '!'
        metadata: '!'
        provider: string!
        requiredChecks: '[]string!'
        successUrl: string!
    - name: UserVerificationStatusResponse
      fields:
        status: '*schema.UserVerificationStatus!'
    - name: WebhookResponse
      fields:
        received: bool!
        status: string!
    - name: ProviderSession
      fields:
        "": string
    - name: Config
      fields:
        acceptedCountries: '[]string!'
        acceptedDocuments: '[]string!'
        autoDeleteAfterExpiry: bool!
        autoRejectHighRisk: bool!
        complianceMode: string!
        customFields: '!'
        dataResidency: string!
        defaultCancelUrl: string!
        defaultProvider: string!
        defaultSuccessUrl: string!
        documentRetentionPeriod: time.Duration!
        enableAuditLog: bool!
        enableManualReview: bool!
        enableReverification: bool!
        enabled: bool!
        gdprCompliant: bool!
        jumio: JumioConfig!
        maxAllowedRiskScore: int!
        maxVerificationAttempts: int!
        maxVerificationsPerDay: int!
        maxVerificationsPerHour: int!
        minConfidenceScore: int!
        minimumAge: int!
        onfido: OnfidoConfig!
        rateLimitEnabled: bool!
        requireAMLScreening: bool!
        requireAgeVerification: bool!
        requireDocumentVerification: bool!
        requireLivenessDetection: bool!
        retainDocuments: bool!
        sessionExpiryDuration: time.Duration!
        stripeIdentity: StripeIdentityConfig!
        verificationExpiry: time.Duration!
        webhookEvents: '[]string!'
        webhookRetryCount: int!
        webhookSecret: string!
        webhookUrl: string!
        webhooksEnabled: bool!
    - name: Handler
      fields:
        "": '*Service'
    - name: Middleware
      fields:
        "": '*Service'
    - name: VerificationResponse
      fields:
        verification: '*schema.IdentityVerification!'
    - name: AMLMatch
      fields:
        "": string
    - name: JumioConfig
      fields:
        apiSecret: string!
        apiToken: string!
        callbackUrl: string!
        dataCenter: string!
        enableAMLScreening: bool!
        enableExtraction: bool!
        enableLiveness: bool!
        enabled: bool!
        enabledCountries: '[]string!'
        enabledDocumentTypes: '[]string!'
        presetId: string!
        verificationType: string!
    - name: CreateVerificationSession_req
      fields:
        cancelUrl: string!
        config: '!'
        metadata: '!'
        provider: string!
        requiredChecks: '[]string!'
        successUrl: string!
    - name: StripeIdentityProvider
      fields:
        "": bool
    - name: CheckSubResult
      fields:
        "": string
    - name: WebhookPayload
      fields:
        "": ""
    - name: OnfidoProvider
      fields:
        "": OnfidoConfig
    - name: ReverifyRequest
      fields:
        reason: string!
    - name: RequestReverification_req
      fields:
        reason: string!
    - name: AdminBlockUser_req
      fields:
        reason: string!
    - name: IDVerificationListResponse
      fields:
        verifications: '[]!'
    - name: JumioProvider
      fields:
        "": JumioConfig
    - name: Service
      fields:
        "": Repository
    - name: mockProvider
      fields:
        "": error
    - name: CreateVerificationRequest
      fields:
        "": xid.ID
    - name: OnfidoConfig
      fields:
        apiToken: string!
        documentCheck: DocumentCheckConfig!
        enabled: bool!
        facialCheck: FacialCheckConfig!
        includeDocumentReport: bool!
        includeFacialReport: bool!
        includeWatchlistReport: bool!
        region: string!
        webhookToken: string!
        workflowId: string!
    - name: DocumentCheckConfig
      fields:
        enabled: bool!
        extractData: bool!
        validateDataConsistency: bool!
        validateExpiry: bool!
    - name: Plugin
      fields:
        "": '*bun.DB'
    - name: UnblockUserRequest
      fields: {}
    - name: VerificationListResponse
      fields:
        limit: int!
        offset: int!
        total: int!
        verifications: '[]*schema.IdentityVerification!'
    - name: IDVerificationErrorResponse
      fields:
        error: string!
    - name: IDVerificationResponse
      fields:
        verification: '!'
