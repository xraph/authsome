plugin_id: core
version: 1.0.0
description: Core authentication and user management
base_path: /api/auth

types:
  - name: User
    description: User account
    fields:
      id: string!
      email: string!
      name: string
      emailVerified: boolean!
      createdAt: string!
      updatedAt: string!
      organizationId: string

  - name: Session
    description: User session
    fields:
      id: string!
      userId: string!
      token: string!
      expiresAt: string!
      ipAddress: string
      userAgent: string
      createdAt: string!

  - name: Device
    description: User device
    fields:
      id: string!
      userId: string!
      name: string
      type: string
      lastUsedAt: string!
      ipAddress: string
      userAgent: string

  - name: MessageResponse
    description: Simple message response
    fields:
      message: string!

  - name: StatusResponse
    description: Status response
    fields:
      status: string!

  - name: SuccessResponse
    description: Success boolean response
    fields:
      success: boolean!

routes:
  - name: SignUp
    description: Create a new user account
    method: POST
    path: /signup
    request:
      email: string!
      password: string!
      name: string
    response:
      user: User!
      session: Session!
    errors:
      - code: 400
        description: Invalid request data
      - code: 409
        description: Email already exists

  - name: SignIn
    description: Sign in with email and password
    method: POST
    path: /signin
    request:
      email: string!
      password: string!
    response:
      user: User!
      session: Session!
      requiresTwoFactor: boolean
    errors:
      - code: 400
        description: Invalid credentials
      - code: 403
        description: Account locked

  - name: SignOut
    description: Sign out and invalidate session
    method: POST
    path: /signout
    auth: true
    response:
      success: boolean!
    errors:
      - code: 401
        description: Not authenticated

  - name: GetSession
    description: Get current session information
    method: GET
    path: /session
    auth: true
    response:
      user: User!
      session: Session!
    errors:
      - code: 401
        description: Not authenticated

  - name: UpdateUser
    description: Update current user profile
    method: POST
    path: /user/update
    auth: true
    request:
      name: string
      email: string
    response:
      user: User!
    errors:
      - code: 400
        description: Invalid request data
      - code: 401
        description: Not authenticated

  - name: ListDevices
    description: List user devices
    method: GET
    path: /devices
    auth: true
    response:
      devices: Device[]!
    errors:
      - code: 401
        description: Not authenticated

  - name: RevokeDevice
    description: Revoke a device
    method: POST
    path: /devices/revoke
    auth: true
    request:
      fingerprint: string!
    response:
      status: string!
    errors:
      - code: 400
        description: Invalid device ID
      - code: 401
        description: Not authenticated

  - name: RefreshSession
    description: Refresh access token using refresh token
    method: POST
    path: /refresh
    request:
      refreshToken: string!
    response:
      session: '!'
      accessToken: string!
      refreshToken: string!
      expiresAt: string!
      refreshExpiresAt: string!
    errors:
      - code: 400
        description: Invalid request
      - code: 401
        description: Invalid or expired refresh token

  - name: RequestPasswordReset
    description: Request password reset link
    method: POST
    path: /password/reset/request
    request:
      email: string!
    response:
      message: string!
    errors:
      - code: 400
        description: Invalid email format

  - name: ResetPassword
    description: Reset password using token
    method: POST
    path: /password/reset/confirm
    request:
      token: string!
      newPassword: string!
    response:
      message: string!
    errors:
      - code: 400
        description: Invalid or expired token

  - name: ValidateResetToken
    description: Validate password reset token
    method: GET
    path: /password/reset/validate
    query:
      token: string!
    response:
      valid: bool!
    errors:
      - code: 400
        description: Missing token parameter

  - name: ChangePassword
    description: Change password for authenticated user
    method: POST
    path: /password/change
    auth: true
    request:
      oldPassword: string!
      newPassword: string!
    response:
      message: string!
    errors:
      - code: 400
        description: Invalid request
      - code: 401
        description: Incorrect current password

  - name: RequestEmailChange
    description: Request email address change
    method: POST
    path: /email/change/request
    auth: true
    request:
      newEmail: string!
    response:
      message: string!
    errors:
      - code: 400
        description: Invalid email or email already taken
      - code: 401
        description: Not authenticated

  - name: ConfirmEmailChange
    description: Confirm email change using token
    method: POST
    path: /email/change/confirm
    request:
      token: string!
    response:
      message: string!
    errors:
      - code: 400
        description: Invalid or expired token

