plugin_id: twofa
version: 1.0.0
description: Two-factor authentication
base_path: /api/auth

types:
  - name: TwoFASetup
    description: 2FA setup information
    fields:
      secret: string!
      qrCode: string!
      backupCodes: string[]!

  - name: TwoFAStatus
    description: 2FA status
    fields:
      enabled: boolean!
      method: string

routes:
  - name: Enable
    description: Enable 2FA for user
    method: POST
    path: /2fa/enable
    auth: true
    request:
      method: string!
    response:
      secret: string!
      qrCode: string!
      backupCodes: string[]!
    errors:
      - code: 400
        description: Invalid method
      - code: 401
        description: Not authenticated
      - code: 409
        description: 2FA already enabled

  - name: Verify
    description: Verify 2FA code
    method: POST
    path: /2fa/verify
    auth: true
    request:
      code: string!
    response:
      success: boolean!
    errors:
      - code: 400
        description: Invalid code
      - code: 401
        description: Not authenticated

  - name: Disable
    description: Disable 2FA for user
    method: POST
    path: /2fa/disable
    auth: true
    request:
      password: string!
    response:
      success: boolean!
    errors:
      - code: 400
        description: Invalid password
      - code: 401
        description: Not authenticated
      - code: 404
        description: 2FA not enabled

  - name: GenerateBackupCodes
    description: Generate new backup codes
    method: POST
    path: /2fa/generate-backup-codes
    auth: true
    response:
      backupCodes: string[]!
    errors:
      - code: 401
        description: Not authenticated
      - code: 404
        description: 2FA not enabled

  - name: SendOTP
    description: Send OTP to user
    method: POST
    path: /2fa/send-otp
    auth: true
    response:
      success: boolean!
    errors:
      - code: 401
        description: Not authenticated
      - code: 429
        description: Too many requests

  - name: Status
    description: Get 2FA status
    method: POST
    path: /2fa/status
    auth: true
    response:
      enabled: boolean!
      method: string
    errors:
      - code: 401
        description: Not authenticated

